import { generateText } from '../../../lib/gemini'; import prisma from '../../../lib/prisma'; export async function POST(req){ try{ const body = await req.json(); const { title, details, tone, userId } = body; const result = await generateText({ title, details, tone }); if(process.env.DATABASE_URL && userId){ await prisma.ad.create({ data:{ title: result.instagramPost?.slice(0,255) || title, description: result.marketplaceDescription || details, userId } }); } return new Response(JSON.stringify(result), { status:200 }); }catch(e){ console.error(e); return new Response(JSON.stringify({ error:true }), { status:500 }); } }
